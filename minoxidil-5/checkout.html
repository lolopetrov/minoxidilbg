<form id="orderForm">
  <label>–ò–º–µ –∏ —Ñ–∞–º–∏–ª–∏—è:</label>
  <input type="text" name="–∏–º–µ" required>

  <label>–¢–µ–ª–µ—Ñ–æ–Ω:</label>
  <input type="tel" name="—Ç–µ–ª–µ—Ñ–æ–Ω" required>

  <label>–ê–¥—Ä–µ—Å –∑–∞ –¥–æ—Å—Ç–∞–≤–∫–∞:</label>
  <textarea name="–∞–¥—Ä–µ—Å" rows="3" required></textarea>

  <!-- Campo de email del cliente con validaci√≥n -->
  <div style="margin-bottom:16px">
    <label for="email" style="font-weight:600;display:block;margin-bottom:6px">
      –í–∞—à–∏—è—Ç –∏–º–µ–π–ª:
    </label>
    <input 
      type="email" 
      id="email" 
      name="email"  <!-- üëà ahora coincide con e.parameter.email -->
      placeholder="name@example.com" 
      required
      style="width:100%;padding:10px;border:1px solid #ccc;border-radius:8px"
    >
    <small id="emailError" style="color:#d32f2f;display:none;font-size:0.85rem">
      –ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –≤–∞–ª–∏–¥–µ–Ω –∏–º–µ–π–ª –∞–¥—Ä–µ—Å.
    </small>
  </div>

  <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
  <input type="number" name="–±—Ä–æ–∏–∫–∏" min="1" value="1">

  <button type="submit">üõí –ò–∑–ø—Ä–∞—Ç–∏ –ø–æ—Ä—ä—á–∫–∞</button>
</form>

<p id="status" style="text-align:center;margin-top:15px;font-weight:600;color:green;display:none">
  ‚úÖ –ü–æ—Ä—ä—á–∫–∞—Ç–∞ –µ –∏–∑–ø—Ä–∞—Ç–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
</p>

<script>
  const form = document.getElementById('orderForm');
  const status = document.getElementById('status');
  const emailInput = document.getElementById('email');
  const emailError = document.getElementById('emailError');

  // Validaci√≥n en tiempo real del email
  emailInput.addEventListener('input', () => {
    if (emailInput.validity.valid) {
      emailError.style.display = 'none';
      emailInput.style.borderColor = '#ccc';
    } else {
      emailError.style.display = 'block';
      emailInput.style.borderColor = '#d32f2f';
    }
  });

  const webAppUrl = "https://script.google.com/macros/s/AKfycbztcMh89CI8F7MWkzKXueM0h99_es965w-lGjdKMapRrTrwjON-xH8L6ByBC5dDJwy-AA/exec";

  function sendOrder(data) {
    const formData = new URLSearchParams(data);
    fetch(webAppUrl, { method:'POST', body: formData })
      .then(r => r.text())
      .then(txt => {
        status.style.color = 'green';
        status.style.display = 'block';
        form.reset();
        status.scrollIntoView({behavior:'smooth', block:'center'});
      })
      .catch(err => {
        status.style.color = 'red';
        status.style.display = 'block';
        status.textContent = '‚ö†Ô∏è –ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∏–∑–ø—Ä–∞—â–∞–Ω–µ. –û–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ.';
        status.scrollIntoView({behavior:'smooth', block:'center'});
      });
  }

  form.addEventListener('submit', e => {
    e.preventDefault();

    const data = {
      –∏–º–µ: form.–∏–º–µ.value,
      —Ç–µ–ª–µ—Ñ–æ–Ω: form.—Ç–µ–ª–µ—Ñ–æ–Ω.value,
      –∞–¥—Ä–µ—Å: form.–∞–¥—Ä–µ—Å.value,
      –±—Ä–æ–∏–∫–∏: form.–±—Ä–æ–∏–∫–∏.value,
      email: form.email.value,          // üëà email se env√≠a con el name correcto
      producto: "–ú–∏–Ω–æ–∫—Å–∏–¥–∏–ª 5%"        // üëà cambia a 2% en el funnel de mujeres
    };

    sendOrder(data);
  });
</script>
