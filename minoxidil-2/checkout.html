<!doctype html>
<html lang="bg">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–ü–æ—Ä—ä—á–∞–π –ú–∏–Ω–æ–∫—Å–∏–¥–∏–ª 5%</title>
<style>
:root{--accent:#1f8a5f;--accent-2:#ff7a59;--bg:#ffffff;--muted:#6b7280}
body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Arial;background:var(--bg);margin:0;padding:20px}
.container{max-width:500px;margin:0 auto;background:#fff;padding:25px;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,0.08)}
h1{text-align:center;margin-bottom:15px}
.product-img{width:100%;border-radius:8px;margin-bottom:15px}
label{display:block;margin:10px 0 5px;font-weight:600}
input,textarea{width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;font-size:1rem}
button{margin-top:18px;background:var(--accent);color:#fff;border:none;padding:12px 0;border-radius:8px;font-size:1rem;width:100%;cursor:pointer;font-weight:700}
#status{text-align:center;margin-top:15px;font-weight:600;color:green;display:none}
</style>
</head>
<body>
<div class="container">
  <h1>–ü–æ—Ä—ä—á–∞–π –ú–∏–Ω–æ–∫—Å–∏–¥–∏–ª 5%</h1>
  <img src="https://minoxidilbg.com/assets/images/minoxidil-kosopad-5-procenta.gif" alt="–ú–∏–Ω–æ–∫—Å–∏–¥–∏–ª 5%" class="product-img">
  <p style="text-align:center;color:var(--muted)">–ü–æ–ø—ä–ª–Ω–µ—Ç–µ –¥–∞–Ω–Ω–∏—Ç–µ –∑–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ (–Ω–∞–ª–æ–∂–µ–Ω –ø–ª–∞—Ç–µ–∂):</p>

  <form id="orderForm">
    <label>–ò–º–µ –∏ —Ñ–∞–º–∏–ª–∏—è:</label>
    <input type="text" name="–∏–º–µ" required>

    <label>–¢–µ–ª–µ—Ñ–æ–Ω:</label>
    <input type="tel" name="—Ç–µ–ª–µ—Ñ–æ–Ω" required>

    <label>–ê–¥—Ä–µ—Å –∑–∞ –¥–æ—Å—Ç–∞–≤–∫–∞:</label>
    <textarea name="–∞–¥—Ä–µ—Å" rows="3" required></textarea>

    <!-- Campo de email del cliente con validaci√≥n y autocompletado -->
    <div style="margin-bottom:16px">
      <label for="customerEmail" style="font-weight:600;display:block;margin-bottom:6px">
        –í–∞—à–∏—è—Ç –∏–º–µ–π–ª:
      </label>
      <input 
        type="email" 
        id="customerEmail" 
        name="customerEmail" 
        placeholder="name@example.com" 
        required
        style="width:100%;padding:10px;border:1px solid #ccc;border-radius:8px"
      >
      <small id="emailError" style="color:#d32f2f;display:none;font-size:0.85rem">
        –ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –≤–∞–ª–∏–¥–µ–Ω –∏–º–µ–π–ª –∞–¥—Ä–µ—Å.
      </small>
    </div>

    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
    <input type="number" name="–±—Ä–æ–∏–∫–∏" min="1" value="1">

    <button type="submit">üõí –ò–∑–ø—Ä–∞—Ç–∏ –ø–æ—Ä—ä—á–∫–∞</button>
  </form>

  <p id="status">‚úÖ –ü–æ—Ä—ä—á–∫–∞—Ç–∞ –µ –∏–∑–ø—Ä–∞—Ç–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!</p>
</div>

<script>
  const emailInput = document.getElementById('customerEmail');
  const emailError = document.getElementById('emailError');

  // ‚úÖ Cargar email guardado si existe
  const savedEmail = localStorage.getItem('checkoutEmail');
  if (savedEmail) {
    emailInput.value = savedEmail;
  }

  // Validaci√≥n en tiempo real y guardado en localStorage
  emailInput.addEventListener('input', () => {
    if (emailInput.validity.valid) {
      emailError.style.display = 'none';
      emailInput.style.borderColor = '#ccc';
      localStorage.setItem('checkoutEmail', emailInput.value);
    } else {
      emailError.style.display = 'block';
      emailInput.style.borderColor = '#d32f2f';
    }
  });

  const form = document.getElementById('orderForm');
  const status = document.getElementById('status');
  const webAppUrl = "https://script.google.com/macros/s/AKfycbztcMh89CI8F7MWkzKXueM0h99_es965w-lGjdKMapRrTrwjON-xH8L6ByBC5dDJwy-AA/exec";

  function sendOrder(data) {
    const formData = new URLSearchParams(data);
    fetch(webAppUrl, { method:'POST', body: formData })
      .then(r => r.text())
      .then(txt => {
        status.style.color = 'green';
        status.style.display = 'block';
        form.reset();
        localStorage.removeItem('checkoutEmail'); // ‚úÖ limpiar email al finalizar
        status.scrollIntoView({behavior:'smooth', block:'center'});
      })
      .catch(err => {
        status.style.color = 'red';
        status.style.display = 'block';
        status.textContent = '‚ö†Ô∏è –ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∏–∑–ø—Ä–∞—â–∞–Ω–µ. –û–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ.';
        status.scrollIntoView({behavior:'smooth', block:'center'});
      });
  }

  form.addEventListener('submit', e => {
    e.preventDefault();
    const data = {
      –∏–º–µ: form.–∏–º–µ.value,
      —Ç–µ–ª–µ—Ñ–æ–Ω: form.—Ç–µ–ª–µ—Ñ–æ–Ω.value,
      –∞–¥—Ä–µ—Å: form.–∞–¥—Ä–µ—Å.value,
      customerEmail: form.customerEmail.value,
      –±—Ä–æ–∏–∫–∏: form.–±—Ä–æ–∏–∫–∏.value
    };
    sendOrder(data);
  });
</script>
</body>
</html>
